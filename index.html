<!DOCTYPE html>

<html lang="sv">

<head>

  <meta charset="utf-8">

  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Ivar â€“ SMS-Spamfilter (TensorFlow.js)</title>

 

  <script src=https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@4.20.0/dist/tf.min.js></script>

 

  <style>

    :root {

      --bg: #f5f7fb;

      --card: #ffffff;

      --primary: #2563eb;

      --primary-dark: #1e40af;

      --muted: #64748b;

      --text: #0f172a;

      --success: #16a34a;

      --danger: #dc2626;

    }

 

    * { box-sizing: border-box; }

 

    body {

      margin: 0;

      font-family: system-ui, -apple-system, Segoe UI, Roboto, sans-serif;

      background: var(--bg);

      color: var(--text);

      line-height: 1.6;

    }

 

    /* â”€â”€â”€â”€â”€â”€â”€â”€â”€ Header / Hero â”€â”€â”€â”€â”€â”€â”€â”€â”€ */

    header {

      background: linear-gradient(135deg, #1e3a8a, #2563eb);

      color: white;

      padding: 3rem 1.2rem;

      text-align: center;

    }

 

    header h1 {

      margin: 0;

      font-size: 2.6rem;

    }

 

    header p {

      margin-top: 0.7rem;

      opacity: 0.9;

      font-size: 1.1rem;

    }

 

    /* â”€â”€â”€â”€â”€â”€â”€â”€â”€ Main layout â”€â”€â”€â”€â”€â”€â”€â”€â”€ */

    main {

      max-width: 980px;

      margin: auto;

      padding: 2rem 1.2rem 3rem;

    }

 

    .hero-images {

      display: grid;

      grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));

      gap: 1rem;

      margin-top: -3rem;

      margin-bottom: 2.5rem;

    }

 

    .hero-images img {

      width: 100%;

      height: 200px;

      object-fit: cover;

      border-radius: 18px;

      box-shadow: 0 12px 30px rgba(0,0,0,0.15);

    }

 

    /* â”€â”€â”€â”€â”€â”€â”€â”€â”€ Cards â”€â”€â”€â”€â”€â”€â”€â”€â”€ */

    .card {

      background: var(--card);

      border-radius: 18px;

      padding: 1.8rem;

      margin-bottom: 1.6rem;

      box-shadow: 0 10px 30px rgba(0,0,0,0.08);

    }

 

    .card h2 {

      margin-top: 0;

      font-size: 1.5rem;

    }

 

    .step {

      display: flex;

      gap: 14px;

      align-items: flex-start;

    }

 

    .step-number {

      background: var(--primary);

      color: white;

      width: 34px;

      height: 34px;

      border-radius: 50%;

      display: grid;

      place-items: center;

      font-weight: 700;

      flex-shrink: 0;

    }

 

    /* â”€â”€â”€â”€â”€â”€â”€â”€â”€ Inputs â”€â”€â”€â”€â”€â”€â”€â”€â”€ */

    textarea {

      width: 100%;

      min-height: 130px;

      padding: 14px 16px;

      font-size: 16px;

      border-radius: 14px;

      border: 2px solid #c7d2fe;

      margin-top: 1rem;

      resize: vertical;

      font-family: inherit;

    }

 

    textarea:focus {

      outline: none;

      border-color: var(--primary);

      box-shadow: 0 0 0 3px rgba(37,99,235,0.15);

    }

 

    button {

      margin-top: 1rem;

      padding: 12px 22px;

      font-size: 16px;

      border-radius: 999px;

      border: none;

      cursor: pointer;

      background: var(--primary);

      color: white;

      font-weight: 600;

      transition: 0.2s;

    }

 

    button:hover:not(:disabled) {

      background: var(--primary-dark);

      transform: translateY(-1px);

    }

 

    button:disabled {

      background: #94a3b8;

      cursor: not-allowed;

    }

 

    .status {

      margin-left: 14px;

      font-family: ui-monospace, SFMono-Regular, Menlo, monospace;

      font-size: 0.95rem;

      color: var(--muted);

    }

 

    /* â”€â”€â”€â”€â”€â”€â”€â”€â”€ Result â”€â”€â”€â”€â”€â”€â”€â”€â”€ */

    .result {

      background: #f8fafc;

      border-radius: 14px;

      padding: 1.4rem;

      margin-top: 1rem;

      font-family: ui-monospace, SFMono-Regular, Menlo, monospace;

      white-space: pre-wrap;

    }

 

    /* â”€â”€â”€â”€â”€â”€â”€â”€â”€ Footer â”€â”€â”€â”€â”€â”€â”€â”€â”€ */

    footer {

      background: #0f172a;

      color: white;

      text-align: center;

      padding: 1.4rem;

      font-size: 0.9rem;

      opacity: 0.9;

    }

  </style>

</head>

 

<body>

 

<header>

  <h1>ðŸ“© Ivarâ€™s SMS-Spamfilter</h1>

  <p>MaskininlÃ¤rning i webblÃ¤saren med TensorFlow.js</p>

</header>

 

<main>

 

  <section class="hero-images">

    <img src=https://images.unsplash.com/photo-1557200134-90327ee9fafa?w=900&auto=format&fit=crop&q=80>

    <img src=https://images.unsplash.com/photo-1525182008055-f88b95ff7980?w=900&auto=format&fit=crop&q=80>

    <img src=https://images.unsplash.com/photo-1515378791036-0648a3ef77b2?w=900&auto=format&fit=crop&q=80>

  </section>

 

  <div class="card step">

    <div class="step-number">1</div>

    <div>

      <h2>Ladda modellen</h2>

      <p>Modellen laddas lokalt i din webblÃ¤sare. Ingen data skickas ivÃ¤g.</p>

      <button id="btnLoad">Ladda modell</button>

      <span id="status" class="status">Status: ej laddad</span>

    </div>

  </div>

 

  <div class="card step">

    <div class="step-number">2</div>

    <div style="width:100%">

      <h2>Testa ett engelskt SMS</h2>

      <p>Modellen Ã¤r trÃ¤nad pÃ¥ engelska SMS-meddelanden.</p>

 

      <textarea id="input" placeholder="Ex: Congratulations! You have won a FREE prize. Reply WIN now!"></textarea>

 

      <button id="btnPredict" disabled>Klassificera SMS</button>

 

      <div id="out" class="result">VÃ¤ntar pÃ¥ inputâ€¦</div>

    </div>

  </div>

 

</main>

 

<footer>

  Skapad av Ivar â€¢ TensorFlow.js â€¢ KÃ¶rs helt lokalt i webblÃ¤saren

</footer>

 

<!-- ðŸ”’ ML-KODEN Ã„R OÃ„NDRAD -->

<script>

let model = null;

let wordIndex = null;

 

const MODEL_PATH = "./tfjs_model/model.json";

const META_PATH  = "./tfjs_model/metadata.json";

 

const btnLoad = document.getElementById("btnLoad");

const btnPredict = document.getElementById("btnPredict");

const inputEl = document.getElementById("input");

const outEl = document.getElementById("out");

const statusEl = document.getElementById("status");

 

function cleanText(s) {

  return s.toLowerCase()

    .replace(/[â€™]/g, "'")

    .replace(/[^a-z0-9\s']/g, " ")

    .replace(/\s+/g, " ")

    .trim();

}

 

function textToSequence(text, maxLen, oovIndex) {

  const tokens = cleanText(text).split(" ");

  const seq = new Array(maxLen).fill(0);

  for (let i = 0; i < Math.min(tokens.length, maxLen); i++) {

    seq[i] = wordIndex[tokens[i]] ?? oovIndex;

  }

  return seq;

}

 

btnLoad.onclick = async () => {

  try {

    statusEl.textContent = "laddar modellâ€¦";

    const meta = await fetch(META_PATH).then(r => r.json());

    wordIndex = meta.word_index;

 

    model = await tf.loadLayersModel(MODEL_PATH + "?v=" + Date.now());

    const maxLen = model.inputs[0].shape[1];

 

    model._maxLen = maxLen;

    model._oov = wordIndex["<OOV>"] ?? 1;

 

    model.predict(tf.zeros([1, maxLen], "int32")).dispose();

 

    btnPredict.disabled = false;

    statusEl.textContent = "modell laddad âœ…";

  } catch (e) {

    statusEl.textContent = "fel vid laddning âŒ";

    outEl.textContent = e.message;

  }

};

 

btnPredict.onclick = async () => {

  const seq = textToSequence(inputEl.value, model._maxLen, model._oov);

  const x = tf.tensor2d([seq], [1, model._maxLen], "int32");

  const y = model.predict(x);

  const prob = (await y.data())[0];

 

  x.dispose(); y.dispose();

 

  outEl.textContent =

`Klass: ${prob >= 0.5 ? "SPAM" : "HAM"}

Spam-sannolikhet: ${(prob * 100).toFixed(1)} %

 

Tokens:

[${seq.join(", ")}]`;

};

</script>

 

</body>

</html>
